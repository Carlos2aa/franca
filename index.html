<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>FRANÃ‡A â€¢ GESTÃƒO E INTELIGÃŠNCIA</title>
<style>
:root {
  --azul-franca: #0055A4;
  --vermelho-franca: #EF4135;
  --branco: #F5F5F5;
  --fundo-dark: #05070a;
  --card-bg: rgba(17, 25, 40, 0.75);
  --borda: rgba(255, 255, 255, 0.125);
}



* { box-sizing: border-box; transition: all 0.3s ease; }

body {
  margin: 0;
  background-color: var(--fundo-dark);
  background-image: 
    radial-gradient(at 0% 0%, rgba(0, 85, 164, 0.15) 0px, transparent 50%),
    radial-gradient(at 100% 100%, rgba(239, 65, 53, 0.1) 0px, transparent 50%);
  font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
  color: var(--branco);
  min-height: 100vh;
}

header {
  padding: 50px 20px;
  text-align: center;
  background: 
    linear-gradient(to bottom, rgba(5, 7, 10, 0.8), rgba(5, 7, 10, 0.9)), /* Escurece a imagem */
    url('https://wallpapers.com/images/hd/painted-france-flag-tuhyc1qllqp8hdyk.jpg'); /* Exemplo de URL */
  background-size: cover;
  background-position: center;
  border-bottom: 2px solid;
  border-image: linear-gradient(to right, var(--azul-franca), var(--branco), var(--vermelho-franca)) 1;
}

header h1 {
  margin: 0;
  font-size: 60px;
  letter-spacing: 8px;
  text-transform: uppercase;
  text-shadow: 0 0 20px rgba(0, 85, 164, 0.5);
  font-weight: 900;
}

header p {
  margin-top: 10px;
  font-size: 14px;
  letter-spacing: 4px;
  color: #aaa;
  text-transform: uppercase;
}

.container { max-width: 1100px; margin: 0 auto; padding: 40px 20px; }

.card {
  background: var(--card-bg);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border: 1px solid var(--borda);
  border-radius: 12px;
  padding: 30px;
  margin-bottom: 30px;
  box-shadow: 0 15px 35px rgba(0,0,0,0.5);
}

.grid-config { display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 20px; margin-bottom: 20px; }

label {
  display: block;
  font-size: 11px;
  font-weight: 700;
  text-transform: uppercase;
  margin-bottom: 8px;
  color: var(--azul-franca);
  letter-spacing: 1px;
}

input, textarea {
  width: 100%;
  padding: 14px;
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid #222;
  border-radius: 6px;
  color: #fff;
  font-size: 14px;
}

input:focus, textarea:focus {
  outline: none;
  border-color: var(--azul-franca);
  box-shadow: 0 0 10px rgba(0, 85, 164, 0.3);
}

button {
  width: 100%;
  padding: 16px;
  background: linear-gradient(135deg, var(--azul-franca) 0%, #003366 100%);
  color: white;
  border: none;
  border-radius: 6px;
  font-weight: 900;
  text-transform: uppercase;
  letter-spacing: 2px;
  cursor: pointer;
  box-shadow: 0 4px 15px rgba(0,0,0,0.3);
}

button:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(0, 85, 164, 0.4);
  filter: brightness(1.2);
}

.btn-limpar {
  background: transparent;
  border: 1px solid #444;
  margin-top: 10px;
  font-size: 11px;
  padding: 10px;
  color: #888;
}

.btn-limpar:hover { background: rgba(255,255,255,0.05); color: #fff; border-color: #666; }

table { width: 100%; border-collapse: collapse; margin-top: 20px; }

th {
  text-align: center;
  padding: 15px;
  font-size: 12px;
  text-transform: uppercase;
  letter-spacing: 1px;
  color: #666;
  border-bottom: 2px solid #222;
}

td { padding: 18px; text-align: center; border-bottom: 1px solid rgba(255,255,255,0.05); }

.editavel {
  background: rgba(0,0,0,0.5);
  border: 1px solid var(--azul-franca);
  color: #00ff88;
  font-weight: bold;
  text-align: center;
  padding: 8px;
  border-radius: 4px;
  width: 130px;
}

.comissao-positiva { color: #00ff88; font-weight: 800; font-size: 16px; }
.comissao-zerada { color: var(--vermelho-franca); font-weight: 800; font-size: 16px; }

.btn-enviar {
  background: var(--branco);
  color: #000;
  padding: 8px 20px;
  font-size: 12px;
  width: auto;
}

.enviado { background: var(--sucesso) !important; color: white; opacity: 0.5; }

footer {
  text-align: center;
  padding: 40px;
  font-size: 12px;
  color: #444;
  letter-spacing: 2px;
  text-transform: uppercase;
}

footer strong { color: var(--branco); border-bottom: 1px solid var(--vermelho-franca); }

.erro-input { border: 1px solid var(--vermelho-franca) !important; animation: shake 0.4s; }

@keyframes shake {
  0%, 100% {transform: translateX(0);}
  25% {transform: translateX(-5px);}
  75% {transform: translateX(5px);}
}
</style>
</head>
<body>

<header>
  <h1>FRANÃ‡A</h1>
  <p>DEPARTAMENTO DE FINANÃ‡AS â€¢ UNIDADE DE ELITE</p>
</header>

<div class="container">
  <div class="card">
    <div class="grid-config">
      <div>
        <label>CÃ³digo de Acesso (Webhook)</label>
        <input type="password" id="webhook_url" placeholder="Insira o link do canal..." onchange="salvarConfig()">
      </div>
      <div>
        <label>Taxa de Lavagem</label>
        <input type="number" id="perc_lavagem" value="25" onchange="salvarConfig()">
      </div>
      <div>
        <label>ComissÃ£o Membro</label>
        <input type="number" id="perc_comissao" value="40" onchange="salvarConfig()">
      </div>
    </div>
    <label>ResponsÃ¡vel pelo Pagamento</label>
    <input id="pagador" placeholder="Identifique-se para o log..." onchange="salvarConfig()">
  </div>

  <div class="card">
    <label>Logs de OperaÃ§Ã£o</label>
    <textarea id="entrada" placeholder="Cole os logs extraÃ­dos do rÃ¡dio/discord aqui..." style="height:180px;"></textarea>
    <button onclick="processar()">ANALISAR DADOS E GERAR RELATÃ“RIO</button>
    <button class="btn-limpar" onclick="document.getElementById('entrada').value=''">APAGAR EVIDÃŠNCIAS (LIMPAR)</button>
  </div>

  <div class="card" style="overflow-x:auto;">
    <table>
      <thead>
        <tr>
          <th style="text-align:left">Codinome / Vendedor</th>
          <th>OperaÃ§Ãµes</th>
          <th>Volume Sujo</th>
          <th>ComissÃ£o Limpo</th>
          <th>AÃ§Ã£o</th>
        </tr>
      </thead>
      <tbody id="resultado"></tbody>
    </table>
  </div>
</div>

<footer>
  DESENVOLVIDO POR <strong>DEMIAN KALASHNIKOV</strong> â€¢ &copy; ingame.farao@gmail.com.
</footer>

<script>
let relatorio = {};

window.onload = () => {
    document.getElementById('webhook_url').value = localStorage.getItem('franca_webhook') || "";
    document.getElementById('perc_lavagem').value = localStorage.getItem('franca_lavagem') || "25";
    document.getElementById('perc_comissao').value = localStorage.getItem('franca_comissao') || "40";
    document.getElementById('pagador').value = localStorage.getItem('franca_pagador') || "";
};

function salvarConfig() {
    localStorage.setItem('franca_webhook', document.getElementById('webhook_url').value);
    localStorage.setItem('franca_lavagem', document.getElementById('perc_lavagem').value);
    localStorage.setItem('franca_comissao', document.getElementById('perc_comissao').value);
    localStorage.setItem('franca_pagador', document.getElementById('pagador').value);
    if(Object.keys(relatorio).length > 0) renderizarTabela();
}

function processar() {
  relatorio = {};
  let funcAtual = null;
  const texto = document.getElementById("entrada").value;
  const regexDataHora = /(Ontem Ã s|Hoje Ã s|\d{2}\/\d{2}\/\d{4}|\d{2}:\d{2})/gi;

  texto.split("\n").forEach(linha => {
    let l = linha.trim();
    if (!l || l.toLowerCase() === "imagem") return;

    if (l.includes("â€”") || (l.includes("|") && !regexDataHora.test(l))) {
      let nomeLimpo = l.split("â€”")[0].replace(regexDataHora, "").trim();
      if (nomeLimpo && nomeLimpo.length > 3) {
        funcAtual = nomeLimpo;
        if (!relatorio[funcAtual]) relatorio[funcAtual] = { total: 0, vendas: 0 };
        relatorio[funcAtual].vendas++;
      }
      return;
    }

    if (funcAtual && !regexDataHora.test(l)) {
      const match = l.match(/([\d.]+)/);
      if (match) {
        let valor = parseFloat(match[1].replace(/\./g, ''));
        if (!isNaN(valor) && valor > 100) {
          relatorio[funcAtual].total += valor;
        }
      }
    }
  });

  renderizarTabela();
}

function calcularComissao(totalSujo) {
    const pLavagem = parseFloat(document.getElementById('perc_lavagem').value) / 100;
    const pComissao = parseFloat(document.getElementById('perc_comissao').value) / 100;
    const valorAposLavagem = totalSujo * (1 - pLavagem);
    return Math.floor(valorAposLavagem * pComissao);
}

function renderizarTabela() {
  const tb = document.getElementById("resultado");
  tb.innerHTML = "";
  let i = 0;
  Object.entries(relatorio).forEach(([nome, dados]) => {
    const comissao = calcularComissao(dados.total);
    const classeCor = comissao === 0 ? "comissao-zerada" : "comissao-positiva";
    
    tb.innerHTML += `
      <tr>
        <td style="text-align:left; font-size:13px; letter-spacing:1px"><strong>${nome}</strong></td>
        <td><span style="background:rgba(255,255,255,0.1); padding:4px 10px; border-radius:4px">${dados.vendas}</span></td>
        <td>R$ ${dados.total.toLocaleString('pt-BR')}</td>
        <td id="com-${i}" class="${classeCor}">R$ ${comissao.toLocaleString('pt-BR')}</td>
        <td><button class="btn-enviar" id="btn-${i}" onclick="enviar('${nome}', ${i})">CONFIRMAR</button></td>
      </tr>`;
    i++;
  });
}

function enviar(nome, idx) {
  const url = document.getElementById('webhook_url').value;
  const campoPagador = document.getElementById('pagador');
  const pagador = campoPagador.value.trim();

  if (!pagador) {
    campoPagador.classList.add("erro-input");
    setTimeout(() => campoPagador.classList.remove("erro-input"), 2000);
    return alert("ACESSO NEGADO: Identifique o Agente Pagador.");
  }

  if(!url) return alert("ERRO: Link de transmissÃ£o (Webhook) nÃ£o configurado.");

  const d = relatorio[nome];
  const pLavagem = document.getElementById('perc_lavagem').value;
  const pComissao = document.getElementById('perc_comissao').value;
  const comissao = calcularComissao(d.total);

  const payload = {
    embeds: [{
      title: "ðŸ‡«ðŸ‡· RELATÃ“RIO DE PAGAMENTO â€¢ FRANÃ‡A",
      color: comissao === 0 ? 15548997 : 3447003,
      fields: [
        { name: "ðŸ‘¤ Membro", value: `**@${nome}**`, inline: true },
        { name: "ðŸ“¸ OperaÃ§Ãµes", value: String(d.vendas), inline: true },
        { name: "ðŸ’° Montante Sujo", value: `\`R$ ${d.total.toLocaleString('pt-BR')}\``, inline: false },
        { name: "ðŸ’µ ComissÃ£o Limpo", value: `\`R$ ${comissao.toLocaleString('pt-BR')}\``, inline: true },
        { name: "ðŸ‘® Pago por", value: pagador, inline: true }
      ],
      footer: { text: "FRANÃ‡A â€¢ GESTÃƒO DE VENDAS (DROG@S)" },
      timestamp: new Date()
    }]
  };

  fetch(url, { method: 'POST', headers: {'Content-Type':'application/json'}, body: JSON.stringify(payload) })
  .then(() => {
    const b = document.getElementById(`btn-${idx}`);
    b.innerText = "REGISTRADO";
    b.style.background = "#28a745";
    b.disabled = true;
  });
}
</script>
</body>
</html>